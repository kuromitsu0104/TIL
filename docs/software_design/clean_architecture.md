# 概要

## 本

- Clean Architecture 達人に学ぶソフトウェアの構造と設計

# 読書メモ

## 第 1 章 設計とアーキテクチャ

- 設計とアーキテクチャの両者には何も違いはない
  - 下位レベルの詳細と上位レベルの構造は全体の設計の一部となる
  - それらが連続した構造を作り、システムの形状を定義する。どちらも欠くことはできない

### 目的は？

- **ソフトウェアアーキテクチャの目的は、求められるシステムを構築・保守するために必要な人材を最小限に抑えることである。**
  - 必要な労力が少ない => 優れた設計
  - 必要な労力が多い => 優れていない設計

### ケーススタディ

- エンジニアリング部門の人材が増えるごとにリリースサイクルが伸び悩む

### 崩壊のサイン

- 開発者視点では一生懸命働いているが、リリースするたびに生産性が低下してしまう状態
- 生産性が低下する理由 => 崩壊の対応を続けることで昨日の開発がほとんどできないため

### 経営者の視点

- リリースごとに開発者の給与が上昇
- ただし、生産性は低下してリリースサイクルが伸び悩んでしまう

### 何が間違っていたのか？

- イソップの「ウサギとカメ」という物語
  - 「遅くとも着実であれば競争に勝つ」
  - 「競争は短期決戦ではない。強い物が勝つわけではない」
  - 「急げば急ぐほど速度は落ちる」
- 優れた、クリーンな、うまく設計されたコードが**重要である**
- 「あとでクリーンにすればいい。先に市場に出さなければ」
  - => 次の開発が優先され続けて、コードをクリーンにすることに手が回らなくなる
- 崩壊したコードを書くと短期的には速度が上がる => 間違い
  - **崩壊したコードを書くほうがクリーンなコードを書くよりも常に遅い**
  - TDD のほうが全体的に 10%ほど速い
  - 「TDD を使わなかった最速時間よりも、TDD を使った最遅速度のほうが速い」のが真実
- **速く進む方法唯一の方法は、うまく進むことである。**
- 解決策
  - 自ら生み出した崩壊に対して責任を持たせること
- **自信過剰による再設計は、元のプロジェクトと同じように崩壊する**
  - 優れた設計について真剣に向き合うことが、最善の選択肢となる

## 第 2 章 2 つの価値のお話

- すべてのソフトウェアシステムは、ステークホルダーに２つの異なる価値を提供する
  - 「振る舞い」と「構造（アーキテクチャ）」
- 開発者は「振る舞い」と「構造」を維持する責任を持つ
  - 片方だけにフォーカスすることが多く、一方が無視されてしまっている

### 振る舞い

- ソフトウェアに「振る舞い」を与えてステークホルダーの要求を満たす

### アーキテクチャ

- ソフトウェアの 2 つ目の価値は「ソフトウェア」という言葉に関連する
  - ソフトウェア =>「ソフト + ウェア」による複合語
  - ウェア => 「プロダクト」を意味する
- ソフトウェア => マシンの振る舞いを簡単に変更する手段になることを目的としたもの
- ハードウェア => マシンの振る舞いを簡単に変更したくないときに呼ばれるもの
- ソフトウェアは簡単に変更可能でなければならない
  - 変更の難易度は、変更の**形状**ではなく、変更の**スコープ**に比例しなければいけない
    - スコープが狭いにも関わらず変更の難易度が高い => ソフトウェアとしては不適合
- 形状について
  - ソフトウェア開発者は「四角い」ベグを「丸い」穴に打ち込まなければいけないような気持ちになることがある
  - アーキテクチャが特定の「形状」を選択していると、新しい機能がその構造に適さない可能性が高くなる
  - => 形状にとらわれないアーキテクチャにしたほうが現実的

### 大きな価値

- システムが動作することが重要なのか。簡単に変更できることのほうが重要なのか
- ビジネスサイドの意見としては「システムが動作することが重要」を優先しがち
  - **これが間違った態度である理由**
    - 完璧に動作するが、変更できないプログラムの場合
      - 要求が変更されると機能しなくなる、修正することも困難
      - いずれプログラムが役に立たなくなり、作り直すことになる（コスト増）
    - 動作しないが、簡単に変更できるプログラムの場合
      - 要求が変更されても修正可能のため動かし続けられる
      - 引き続きプログラムとして役立つことになる
- 変更コストと作り直すコストを比較して、作り直すコストのほうが低いときは、アーキテクチャに問題を抱えている可能性が高い
- 変更のコストがメリットを上回っており、変更が**事実上できなくなっている**システムは存在する

### アイゼンハワーのマトリックス

- ドワイト・D・アイゼンハワー大統領による「重要度と緊急度のマトリックス」
  - | -                     | -                             |
    | --------------------- | ----------------------------- |
    | 重要<br/>緊急         | 重要<br/>緊急ではない         |
    | 重要ではない<br/>緊急 | 重要ではない<br/>緊急ではない |
  - 「私には緊急と重要の 2 種類の問題がある。緊急と重要は違う。重要なことが緊急になるわけではない。」
  - 優先順位をつけると
    1. 緊急かつ重要
    2. 緊急ではないが重要
    3. 緊急だが重要ではない
    4. 緊急でも重要でもない
  - ソフトウェアに当てはめてみると
    - ソフトウェアの 1 つ目の価値（振る舞い）は緊急だが、常に重要とは限らない
    - ソフトウェアの 2 つ目の価値（アーキテクチャ）は重要だが、常に緊急とは限らない
  -
